{"is_source_file": true, "format": "Python", "description": "This file implements API endpoints for managing two-factor authentication (2FA) using FastAPI. It includes routes to send OTP codes via email, verify OTPs, resend OTPs, and check 2FA status. The code integrates with email and session services and utilizes middleware for user authentication.", "external_files": ["src.models.auth_models", "src.services.email_service", "src.services.session_service", "src.middleware.auth_middleware"], "external_methods": ["email_service.send_otp_email", "email_service.verify_otp", "session_service.revoke_session", "session_service.create_session", "get_current_user"], "published": ["router"], "classes": [{"name": "UserResponse", "description": "Response model representing user information, including verification status."}], "methods": [{"name": "JSONResponse send_2fa_otp( request: TwoFactorSendRequest, current_user: Dict[str, Any] = Depends(get_current_user) )", "description": "API endpoint to send a 6-digit OTP code to the user's email for 2FA.", "scope": "", "scopeKind": ""}, {"name": "JSONResponse verify_2fa_otp( request: TwoFactorRequest, current_user: Dict[str, Any] = Depends(get_current_user) )", "description": "API endpoint to verify OTP code received by the user and complete 2FA, updating session info.", "scope": "", "scopeKind": ""}, {"name": "JSONResponse resend_2fa_otp( request: TwoFactorSendRequest, current_user: Dict[str, Any] = Depends(get_current_user) )", "description": "API endpoint to resend a new OTP code for 2FA.", "scope": "", "scopeKind": ""}, {"name": "JSONResponse get_2fa_status(current_user: Dict[str, Any] = Depends(get_current_user))", "description": "API endpoint to check whether 2FA has been completed for the current session.", "scope": "", "scopeKind": ""}], "calls": ["email_service.send_otp_email", "email_service.verify_otp", "session_service.revoke_session", "session_service.create_session"], "search-terms": ["FastAPI", "2fa", "OTP", "email_service", "session_service", "auth_middleware", "verify-otp", "send-otp", "resend-otp"], "state": 2, "file_id": 17, "knowledge_revision": 46, "git_revision": "", "revision_history": [{"35": ""}, {"46": ""}], "ctags": [{"_type": "tag", "name": "get_2fa_status", "path": "/home/kavia/workspace/code-generation/secure-user-authentication-platform-11890-11899/supabase_auth_backend/src/api/routes/two_factor.py", "pattern": "/^async def get_2fa_status(current_user: Dict[str, Any] = Depends(get_current_user)) -> JSONRespon/", "language": "Python", "typeref": "typename:JSONResponse", "kind": "function", "signature": "(current_user: Dict[str, Any] = Depends(get_current_user))"}, {"_type": "tag", "name": "logger", "path": "/home/kavia/workspace/code-generation/secure-user-authentication-platform-11890-11899/supabase_auth_backend/src/api/routes/two_factor.py", "pattern": "/^logger = logging.getLogger(__name__)$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "resend_2fa_otp", "path": "/home/kavia/workspace/code-generation/secure-user-authentication-platform-11890-11899/supabase_auth_backend/src/api/routes/two_factor.py", "pattern": "/^async def resend_2fa_otp($/", "language": "Python", "typeref": "typename:JSONResponse", "kind": "function", "signature": "( request: TwoFactorSendRequest, current_user: Dict[str, Any] = Depends(get_current_user) )"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/secure-user-authentication-platform-11890-11899/supabase_auth_backend/src/api/routes/two_factor.py", "pattern": "/^router = APIRouter(prefix=\"\\/2fa\", tags=[\"Two-Factor Authentication\"])$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "send_2fa_otp", "path": "/home/kavia/workspace/code-generation/secure-user-authentication-platform-11890-11899/supabase_auth_backend/src/api/routes/two_factor.py", "pattern": "/^async def send_2fa_otp($/", "language": "Python", "typeref": "typename:JSONResponse", "kind": "function", "signature": "( request: TwoFactorSendRequest, current_user: Dict[str, Any] = Depends(get_current_user) )"}, {"_type": "tag", "name": "verify_2fa_otp", "path": "/home/kavia/workspace/code-generation/secure-user-authentication-platform-11890-11899/supabase_auth_backend/src/api/routes/two_factor.py", "pattern": "/^async def verify_2fa_otp($/", "language": "Python", "typeref": "typename:JSONResponse", "kind": "function", "signature": "( request: TwoFactorRequest, current_user: Dict[str, Any] = Depends(get_current_user) )"}], "hash": "86ab52e8c05c2b61bf5d1ad8d0deaef7", "format-version": 4, "code-base-name": "supabase_auth_backend", "filename": "supabase_auth_backend/src/api/routes/two_factor.py", "fields": [{"name": "logger = logging.getLogger(__name__)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "router = APIRouter(prefix=\"\\/2fa\", tags=[\"Two-Factor Authentication\"])", "scope": "", "scopeKind": "", "description": "unavailable"}]}