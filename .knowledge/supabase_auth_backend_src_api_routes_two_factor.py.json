{"is_source_file": true, "format": "Python", "description": "This file defines FastAPI routes for implementing two-factor authentication (2FA) via email OTPs. It includes endpoints to send, verify, resend OTPs, and check 2FA status, utilizing external email and session services, and depends on an authentication middleware.", "external_files": ["src.models.auth_models", "src.services.email_service", "src.services.session_service", "src.middleware.auth_middleware"], "external_methods": ["email_service.send_otp_email", "email_service.verify_otp", "session_service.revoke_session", "session_service.create_session", "get_current_user"], "published": ["router"], "classes": [], "methods": [{"name": "JSONResponse send_2fa_otp( request: TwoFactorSendRequest, current_user: Dict[str, Any] = Depends(get_current_user) )", "description": "Handles sending a 2FA OTP code via email after verifying the request and user state.", "scope": "", "scopeKind": ""}, {"name": "JSONResponse verify_2fa_otp( request: TwoFactorRequest, current_user: Dict[str, Any] = Depends(get_current_user) )", "description": "Verifies the provided OTP code, revokes the preliminary session, and creates a new session with completed 2FA.", "scope": "", "scopeKind": ""}, {"name": "JSONResponse resend_2fa_otp( request: TwoFactorSendRequest, current_user: Dict[str, Any] = Depends(get_current_user) )", "description": "Resends a new OTP code to the user's email, invalidating previous codes.", "scope": "", "scopeKind": ""}, {"name": "JSONResponse get_2fa_status(current_user: Dict[str, Any] = Depends(get_current_user))", "description": "Checks whether 2FA has been completed for the current session.", "scope": "", "scopeKind": ""}], "calls": ["email_service.send_otp_email", "email_service.verify_otp", "session_service.revoke_session", "session_service.create_session", "get_current_user"], "search-terms": ["two-factor authentication", "OTP email", "verify OTP", "resend OTP", "2fa status", "FastAPI routes", "email_service"], "state": 2, "file_id": 17, "knowledge_revision": 79, "git_revision": "6dafa50075f04a71454021837ee566c2f1a9de42", "revision_history": [{"35": ""}, {"46": ""}, {"68": "6ad20ab69f3fbc943e47aacf4d49fc9b4afde8e7"}, {"69": "6ad20ab69f3fbc943e47aacf4d49fc9b4afde8e7"}, {"70": "6ad20ab69f3fbc943e47aacf4d49fc9b4afde8e7"}, {"71": "6ad20ab69f3fbc943e47aacf4d49fc9b4afde8e7"}, {"72": "6ad20ab69f3fbc943e47aacf4d49fc9b4afde8e7"}, {"75": "6ad20ab69f3fbc943e47aacf4d49fc9b4afde8e7"}, {"76": "e4192b60cedd0518cf4cf63647dc270f7a1f9650"}, {"79": "6dafa50075f04a71454021837ee566c2f1a9de42"}], "ctags": [{"_type": "tag", "name": "get_2fa_status", "path": "/home/kavia/workspace/code-generation/secure-user-authentication-platform-11890-11899/supabase_auth_backend/src/api/routes/two_factor.py", "pattern": "/^async def get_2fa_status(current_user: Dict[str, Any] = Depends(get_current_user)) -> JSONRespon/", "language": "Python", "typeref": "typename:JSONResponse", "kind": "function", "signature": "(current_user: Dict[str, Any] = Depends(get_current_user))"}, {"_type": "tag", "name": "logger", "path": "/home/kavia/workspace/code-generation/secure-user-authentication-platform-11890-11899/supabase_auth_backend/src/api/routes/two_factor.py", "pattern": "/^logger = logging.getLogger(__name__)$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "resend_2fa_otp", "path": "/home/kavia/workspace/code-generation/secure-user-authentication-platform-11890-11899/supabase_auth_backend/src/api/routes/two_factor.py", "pattern": "/^async def resend_2fa_otp($/", "language": "Python", "typeref": "typename:JSONResponse", "kind": "function", "signature": "( request: TwoFactorSendRequest, current_user: Dict[str, Any] = Depends(get_current_user) )"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/secure-user-authentication-platform-11890-11899/supabase_auth_backend/src/api/routes/two_factor.py", "pattern": "/^router = APIRouter(prefix=\"\\/2fa\", tags=[\"Two-Factor Authentication\"])$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "send_2fa_otp", "path": "/home/kavia/workspace/code-generation/secure-user-authentication-platform-11890-11899/supabase_auth_backend/src/api/routes/two_factor.py", "pattern": "/^async def send_2fa_otp($/", "language": "Python", "typeref": "typename:JSONResponse", "kind": "function", "signature": "( request: TwoFactorSendRequest, current_user: Dict[str, Any] = Depends(get_current_user) )"}, {"_type": "tag", "name": "verify_2fa_otp", "path": "/home/kavia/workspace/code-generation/secure-user-authentication-platform-11890-11899/supabase_auth_backend/src/api/routes/two_factor.py", "pattern": "/^async def verify_2fa_otp($/", "language": "Python", "typeref": "typename:JSONResponse", "kind": "function", "signature": "( request: TwoFactorRequest, current_user: Dict[str, Any] = Depends(get_current_user) )"}], "hash": "ca42c0ed1dcb60d6554f58a16e6c04af", "format-version": 4, "code-base-name": "supabase_auth_backend", "filename": "supabase_auth_backend/src/api/routes/two_factor.py", "fields": [{"name": "logger = logging.getLogger(__name__)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "router = APIRouter(prefix=\"\\/2fa\", tags=[\"Two-Factor Authentication\"])", "scope": "", "scopeKind": "", "description": "unavailable"}]}